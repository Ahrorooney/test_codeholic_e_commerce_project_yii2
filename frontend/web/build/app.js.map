{"version":3,"sources":["webpack://yii2-ecommerce/./frontend/js/app.js"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,GAAG;AACtB;AACA;AACA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB,0BAA0B;AAC7C;AACA;AACA;AACA;AACA,SAAS;AACT,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,SAAS;AACT;AACA,SAAS;AACT,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,CAAC,E","file":"app.js","sourcesContent":["$(function(){\r\n    const $cartQuantity = $('#cart-quantity');\r\n    const $addToCart = $('.btn-add-to-cart');\r\n    const $itemQuantities = $('.item-quantity');\r\n    const $balanceUser = $('#balance_user');\r\n    const $checkWalletBalance = $('#checkWalletBalance');\r\n    const $balanceUsername = $('#balance_username');\r\n    const $balancePassword = $('#balancePassword');\r\n    const $payTheCheckout = $('#payTheCheckout');\r\n\r\n    $addToCart.click(ev => {\r\n        ev.preventDefault();\r\n        const $this = $(ev.target);\r\n        const id = $this.closest('.product-item').data('key');\r\n        $.ajax({\r\n            method: 'POST',\r\n            url: $this.attr('href'),\r\n            data: {id},\r\n            success: function(){\r\n                $cartQuantity.text(parseInt($cartQuantity.text() || 0)+1);\r\n            }\r\n        })\r\n    })\r\n\r\n    $itemQuantities.change(ev => {\r\n        const $this = $(ev.target);\r\n        let $tr = $this.closest('tr');\r\n        const $td = $this.closest('td');\r\n        const id  = $tr.data('id');\r\n        $.ajax({\r\n            method: 'post',\r\n            url: $tr.data('url'),\r\n            data: {id, quantity: $this.val()},\r\n            success: function(result){\r\n                $cartQuantity.text(result.quantity)\r\n                $td.next().text(result.price);\r\n            }\r\n        })\r\n    })\r\n    $checkWalletBalance.click(ev => {\r\n        ev.preventDefault();\r\n        const $this = $(ev.target);\r\n        // let $url = 'http://online-bank.test/wallet/my-balance?username='+$balanceUsername.text()+'&password='+$balancePassword.val();\r\n        let $url = 'http://distributor-pharmacy.test/v1/api/catalogue-medicine';\r\n        $.ajax({\r\n            method: 'get',\r\n            url: $url,\r\n\r\n        }).done(function(data){\r\n            $balanceUser.text(data.balance);\r\n        });\r\n    })\r\n\r\n    $payTheCheckout.click(ev => {\r\n        ev.preventDefault();\r\n        const $this = $(ev.target);\r\n        const $totalCost = $totalAmountPay;\r\n        let $url = 'http://online-bank.test/wallet/pay?username='+$balanceUsername.text()+'&password='+$balancePassword.val()+'&amount=' +$totalCost;\r\n        $.ajax({\r\n            method: 'get',\r\n            url: $url,\r\n        }).done(function(data){\r\n            $balanceUser.text('Payment: '+data.payment + 'Balance: ' + data.balance);\r\n            orderCapture(data.transaction_id, 1)\r\n        });\r\n    })\r\n\r\n    function orderCapture(transaction_id, status){\r\n        const $form = $('#checkout-form');\r\n        const data = $form.serializeArray();\r\n        const $orderId = $order_id;\r\n        data.push({\r\n            name: 'transaction_id',\r\n            value: transaction_id\r\n        })\r\n        data.push({\r\n            name: 'status',\r\n            value: status\r\n        })\r\n        $.ajax({\r\n            method: 'post',\r\n            url: '/cart/submit-payment?orderId='+$orderId,\r\n            data: data,\r\n            success: function(res) {\r\n                alert(\"Thanks for your business\");\r\n                window.location.href = '';\r\n            }\r\n        })\r\n    }\r\n});"],"sourceRoot":""}